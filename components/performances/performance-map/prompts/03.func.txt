# Performance Map - ê¸°ëŠ¥ ëª…ì„¸

## Props ì¸í„°í˜ì´ìŠ¤

```typescript
interface Venue {
  name: string;
  address: string;
  lat: number;
  lng: number;
}

interface PerformanceMapProps {
  venue?: Venue | null;
  className?: string;
}
```

## í˜„ì¬ êµ¬í˜„ ìƒíƒœ âœ…

### 1. Kakao Map í†µí•©
- Kakao Map SDK ë¡œë“œ í™•ì¸
- Map ìƒì„± ë° ì´ˆê¸°í™”
- ë§ˆì»¤ í‘œì‹œ
- ì¸í¬ìœˆë„ìš° í‘œì‹œ

### 2. ìƒíƒœ ê´€ë¦¬
- ë¡œë”© ìƒíƒœ: `isLoading`
- ì—ëŸ¬ ìƒíƒœ: `error`
- Map ì¸ìŠ¤í„´ìŠ¤: `mapInstanceRef`

### 3. Fallback ì²˜ë¦¬
- Venue ì—†ì„ ë•Œ: Fallback UI
- SDK ë¡œë“œ ì‹¤íŒ¨: ì—ëŸ¬ ë©”ì‹œì§€
- Map ì´ˆê¸°í™” ì‹¤íŒ¨: ì—ëŸ¬ ì²˜ë¦¬

## ê°œì„ ì´ í•„ìš”í•œ ê¸°ëŠ¥ ğŸ”§

### 1. ë‹¤í¬ëª¨ë“œ ì§€ì› â­
**í˜„ì¬:** ì¸í¬ìœˆë„ìš° ìŠ¤íƒ€ì¼ì´ ê³ ì • (white ë°°ê²½)  
**í•„ìš”í•œ ê¸°ëŠ¥:**
```typescript
useEffect(() => {
  // ë‹¤í¬ëª¨ë“œ ê°ì§€
  const mediaQuery = window.matchMedia('(prefers-color-scheme: dark)');
  const isDarkMode = mediaQuery.matches;
  
  // ë˜ëŠ” next-themes ì‚¬ìš©
  const theme = document.documentElement.classList.contains('dark');
  
  const infowindowContent = `
    <div style="
      padding: 12px;
      background: ${isDarkMode ? '#1f2937' : 'white'};
      color: ${isDarkMode ? '#e5e7eb' : '#1f2937'};
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    ">
      <h4 style="color: ${isDarkMode ? '#f3f4f6' : '#1f2937'};">
        ${venue.name}
      </h4>
      <p style="color: ${isDarkMode ? '#9ca3af' : '#6b7280'};">
        ${venue.address}
      </p>
    </div>
  `;
}, [venue, theme]);
```

### 2. ê¸¸ì°¾ê¸° ë²„íŠ¼ â­
**í•„ìš”í•œ ê¸°ëŠ¥:**
```typescript
interface PerformanceMapProps {
  venue?: Venue | null;
  className?: string;
  showNavigationButton?: boolean;  // ê¸¸ì°¾ê¸° ë²„íŠ¼ í‘œì‹œ ì—¬ë¶€
  onNavigate?: () => void;  // ê¸¸ì°¾ê¸° ë²„íŠ¼ í´ë¦­ í•¸ë“¤ëŸ¬
}

// Map í•˜ë‹¨ì— ê¸¸ì°¾ê¸° ë²„íŠ¼ ì¶”ê°€
{showNavigationButton && (
  <Button
    className="absolute bottom-2 left-1/2 -translate-x-1/2 z-10"
    onClick={handleNavigate}
  >
    <Navigation className="size-4 mr-2" />
    ê¸¸ì°¾ê¸°
  </Button>
)}
```

### 3. ì»¤ìŠ¤í…€ ë§ˆì»¤ ì´ë¯¸ì§€
**í•„ìš”í•œ ê¸°ëŠ¥:**
```typescript
interface PerformanceMapProps {
  // ...
  markerImage?: string;  // ì»¤ìŠ¤í…€ ë§ˆì»¤ ì´ë¯¸ì§€ URL
  markerSize?: { width: number; height: number };
}

// ë§ˆì»¤ ìƒì„± ì‹œ
const markerImage = new window.kakao.maps.MarkerImage(
  markerImage || '/default-marker.png',
  new window.kakao.maps.Size(markerSize?.width || 64, markerSize?.height || 64),
  { offset: new window.kakao.maps.Point(32, 64) }
);

const marker = new window.kakao.maps.Marker({
  position: markerPosition,
  image: markerImage,
});
```

### 4. ì§€ë„ ë ˆë²¨ ì¡°ì ˆ
**í•„ìš”í•œ ê¸°ëŠ¥:**
```typescript
interface PerformanceMapProps {
  // ...
  zoomLevel?: number;  // ê¸°ë³¸ê°’: 3
  showZoomControls?: boolean;  // ì¤Œ ì»¨íŠ¸ë¡¤ í‘œì‹œ ì—¬ë¶€
}

const mapOption = {
  center: new window.kakao.maps.LatLng(lat, lng),
  level: zoomLevel || 3,
  // ì¤Œ ì»¨íŠ¸ë¡¤ ì¶”ê°€
  ...(showZoomControls && {
    disableDoubleClickZoom: false,
  }),
};
```

### 5. ì—¬ëŸ¬ ë§ˆì»¤ í‘œì‹œ (ì£¼ë³€ ì¥ì†Œ)
**í•„ìš”í•œ ê¸°ëŠ¥:**
```typescript
interface PerformanceMapProps {
  // ...
  nearbyPlaces?: Array<{
    name: string;
    address: string;
    lat: number;
    lng: number;
    type: 'restaurant' | 'parking' | 'subway';
  }>;
}

// ì£¼ë³€ ì¥ì†Œ ë§ˆì»¤ ì¶”ê°€
nearbyPlaces?.forEach(place => {
  const placeMarker = new window.kakao.maps.Marker({
    position: new window.kakao.maps.LatLng(place.lat, place.lng),
    // íƒ€ì…ë³„ ë‹¤ë¥¸ ë§ˆì»¤ ì´ë¯¸ì§€ ì‚¬ìš©
  });
  placeMarker.setMap(map);
});
```

### 6. í´ëŸ¬ìŠ¤í„°ë§ (ë§ì€ ë§ˆì»¤ì¼ ë•Œ)
**í•„ìš”í•œ ê¸°ëŠ¥:**
- ì£¼ë³€ ì¥ì†Œê°€ ë§ì„ ë•Œ í´ëŸ¬ìŠ¤í„°ë§ ì ìš©
- ì¹´ì¹´ì˜¤ ë§µ ë§ˆì»¤ í´ëŸ¬ìŠ¤í„°ë§ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš©

## API ì—°ë™ ê³„íš

### ì£¼ì†Œ â†’ ì¢Œí‘œ ë³€í™˜ (Geocoding)
```typescript
// ì£¼ì†Œë§Œ ìˆê³  ì¢Œí‘œê°€ ì—†ì„ ë•Œ
async function geocodeAddress(address: string) {
  if (USE_MOCK_MODE) {
    // Mock ì¢Œí‘œ ë°˜í™˜
    return { lat: 37.5665, lng: 126.9780 };
  }
  
  // Kakao Geocoding API ì‚¬ìš©
  const response = await fetch(
    `https://dapi.kakao.com/v2/local/search/address.json?query=${encodeURIComponent(address)}`,
    {
      headers: {
        Authorization: `KakaoAK ${KAKAO_API_KEY}`,
      },
    }
  );
  
  const data = await response.json();
  if (data.documents.length > 0) {
    return {
      lat: parseFloat(data.documents[0].y),
      lng: parseFloat(data.documents[0].x),
    };
  }
  
  throw new Error('ì£¼ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
}
```

## í…ŒìŠ¤íŠ¸ ê³„íš

### ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
- Props ì „ë‹¬ í…ŒìŠ¤íŠ¸
- Venue ì—†ì„ ë•Œ Fallback UI í…ŒìŠ¤íŠ¸
- ì—ëŸ¬ ìƒíƒœ ì²˜ë¦¬ í…ŒìŠ¤íŠ¸

### í†µí•© í…ŒìŠ¤íŠ¸
- Kakao Map SDK ë¡œë“œ í™•ì¸
- Map ì´ˆê¸°í™” í…ŒìŠ¤íŠ¸
- ë§ˆì»¤ ë° ì¸í¬ìœˆë„ìš° í‘œì‹œ í…ŒìŠ¤íŠ¸

### E2E í…ŒìŠ¤íŠ¸
- Map ë¡œë“œ â†’ ë§ˆì»¤ í‘œì‹œ í”Œë¡œìš°
- ê¸¸ì°¾ê¸° ë²„íŠ¼ í´ë¦­ â†’ ì™¸ë¶€ ì•±/ì›¹ ì—´ê¸°

## ì„±ëŠ¥ ìµœì í™”

### ë©”ëª¨ì´ì œì´ì…˜
```typescript
export const PerformanceMap = React.memo(
  PerformanceMapComponent,
  (prevProps, nextProps) => {
    return (
      prevProps.venue?.lat === nextProps.venue?.lat &&
      prevProps.venue?.lng === nextProps.venue?.lng
    );
  }
);
```

### ì§€ë„ ì¸ìŠ¤í„´ìŠ¤ ê´€ë¦¬
- ì»´í¬ë„ŒíŠ¸ ì–¸ë§ˆìš´íŠ¸ ì‹œ Map ì¸ìŠ¤í„´ìŠ¤ ì •ë¦¬
- ì¤‘ë³µ ì´ˆê¸°í™” ë°©ì§€

## ì ‘ê·¼ì„± (a11y)

### ARIA ë ˆì´ë¸”
```tsx
<div
  ref={mapRef}
  role="img"
  aria-label={`${venue.name} ìœ„ì¹˜ ì§€ë„`}
  aria-describedby="map-description"
/>
<div id="map-description" className="sr-only">
  {venue.name}ì€(ëŠ”) {venue.address}ì— ìœ„ì¹˜í•©ë‹ˆë‹¤.
</div>
```

## í™˜ê²½ ì„¤ì •

### Kakao Map SDK ë¡œë“œ
- `index.html`ì— ìŠ¤í¬ë¦½íŠ¸ ì¶”ê°€
- ë˜ëŠ” ë™ì  ë¡œë“œ (`useEffect` ë‚´)

```html
<script
  type="text/javascript"
  src="//dapi.kakao.com/v2/maps/sdk.js?appkey=YOUR_KAKAO_APP_KEY&autoload=false"
></script>
```

### í™˜ê²½ ë³€ìˆ˜
```env
VITE_KAKAO_MAP_API_KEY=your_kakao_map_api_key
```
